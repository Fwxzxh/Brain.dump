<!doctype html>
<html lang="en">
<head>
<title>Switching, Routing, and Wireles Essentials MOC.</title>
<!-- 2020-12-28 Mon 19:11 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Org-mode">
<meta name="author" content="J.D Castro">

<link  href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
<style>
/* org mode styles on top of twbs */

html {
    position: relative;
    min-height: 100%;
}

body {
    font-size: 18px;
    margin-bottom: 105px;
}

footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 101px;
    background-color: #f5f5f5;
}

footer > div {
    padding: 10px;
}

footer p {
    margin: 0 0 5px;
    text-align: center;
    font-size: 16px;
}

#table-of-contents {
    margin-top: 20px;
    margin-bottom: 20px;
}

blockquote p {
    font-size: 18px;
}

pre {
    font-size: 16px;
}

.footpara {
    display: inline-block;
}

figcaption {
  font-size: 16px;
  color: #666;
  font-style: italic;
  padding-bottom: 15px;
}

/* from twbs docs */

.bs-docs-sidebar.affix {
    position: static;
}
@media (min-width: 768px) {
    .bs-docs-sidebar {
        padding-left: 20px;
    }
}

/* All levels of nav */
.bs-docs-sidebar .nav > li > a {
    display: block;
    padding: 4px 20px;
    font-size: 14px;
    font-weight: 500;
    color: #999;
}
.bs-docs-sidebar .nav > li > a:hover,
.bs-docs-sidebar .nav > li > a:focus {
    padding-left: 19px;
    color: #A1283B;
    text-decoration: none;
    background-color: transparent;
    border-left: 1px solid #A1283B;
}
.bs-docs-sidebar .nav > .active > a,
.bs-docs-sidebar .nav > .active:hover > a,
.bs-docs-sidebar .nav > .active:focus > a {
    padding-left: 18px;
    font-weight: bold;
    color: #A1283B;
    background-color: transparent;
    border-left: 2px solid #A1283B;
}

/* Nav: second level (shown on .active) */
.bs-docs-sidebar .nav .nav {
    display: none; /* Hide by default, but at >768px, show it */
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 30px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav > li > a:focus {
    padding-left: 29px;
}
.bs-docs-sidebar .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav > .active:focus > a {
    padding-left: 28px;
    font-weight: 500;
}

/* Nav: third level (shown on .active) */
.bs-docs-sidebar .nav .nav .nav {
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 40px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav .nav > li > a:focus {
    padding-left: 39px;
}
.bs-docs-sidebar .nav .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav .nav > .active:focus > a {
    padding-left: 38px;
    font-weight: 500;
}

/* Show and affix the side nav when space allows it */
@media (min-width: 992px) {
    .bs-docs-sidebar .nav > .active > ul {
        display: block;
    }
    /* Widen the fixed sidebar */
    .bs-docs-sidebar.affix,
    .bs-docs-sidebar.affix-bottom {
        width: 213px;
    }
    .bs-docs-sidebar.affix {
        position: fixed; /* Undo the static from mobile first approach */
        top: 20px;
    }
    .bs-docs-sidebar.affix-bottom {
        position: absolute; /* Undo the static from mobile first approach */
    }
    .bs-docs-sidebar.affix .bs-docs-sidenav,.bs-docs-sidebar.affix-bottom .bs-docs-sidenav {
        margin-top: 0;
        margin-bottom: 0
    }
}
@media (min-width: 1200px) {
    /* Widen the fixed sidebar again */
    .bs-docs-sidebar.affix-bottom,
    .bs-docs-sidebar.affix {
        width: 263px;
    }
}
</style>
<script>
$(function() {
    'use strict';

    $('.bs-docs-sidebar li').first().addClass('active');

    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    $('.bs-docs-sidebar').affix();
});
</script><style>pre { font-size: 16px; background-color: #2E3440; color: #bbb; }</style>
</head>
<body>
<div id="content" class="container">
<div class="row"><div class="col-md-3 col-md-push-9"><nav id="table-of-contents">
<div id="text-table-of-contents" class="bs-docs-sidebar">
<ul class="nav">
<li><a href="#sec-1">1. Basic Device Configurations</a></li>
<li><a href="#sec-2">2. Switching Concepts</a></li>
<li><a href="#sec-3">3. VLANs</a></li>
<li><a href="#sec-4">4. Inter-VLAN Routing</a>
<ul class="nav">
<li><a href="#sec-4-1">4.1. Inter-VLAN Routing Operation</a>
<ul class="nav">
<li><a href="#sec-4-1-1">4.1.1. What is inter-VLAN Routing</a></li>
<li><a href="#sec-4-1-2">4.1.2. Legacy inter-VLAN Routing</a></li>
<li><a href="#sec-4-1-3">4.1.3. Router-on-a-Stick inter-VLAN Routing</a></li>
<li><a href="#sec-4-1-4">4.1.4. Inter-VLAN routing on a Layer 3 Switch</a></li>
</ul>
</li>
<li><a href="#sec-4-2">4.2. Router-on-a-Stick inter-VLAN Routing</a>
<ul class="nav">
<li><a href="#sec-4-2-1">4.2.1. Router-on-a-Stick scenario</a></li>
<li><a href="#sec-4-2-2">4.2.2. S1 VLAN and Trunking Configuration</a></li>
<li><a href="#sec-4-2-3">4.2.3. S2 VLAN and Trunking Configuration</a></li>
<li><a href="#sec-4-2-4">4.2.4. R1 Subinterface Configuration</a></li>
<li><a href="#sec-4-2-5">4.2.5. Verify Connectivity Between PC1 and PC2</a></li>
<li><a href="#sec-4-2-6">4.2.6. Router-on-a-Stick Inter-VLAN Routing Verification</a></li>
</ul>
</li>
<li><a href="#sec-4-3">4.3. Inter-VLAN Routing using Layer 3 Switches</a>
<ul class="nav">
<li><a href="#sec-4-3-1">4.3.1. Layer 3 Switch Inter-VLAN Routing</a></li>
<li><a href="#sec-4-3-2">4.3.2. Layer 3 Switch Scenario</a></li>
<li><a href="#sec-4-3-3">4.3.3. Layer 3 Switch Configuration</a></li>
<li><a href="#sec-4-3-4">4.3.4. Layer 3 Switch Inter-VLAN Routing Verifcation</a></li>
<li><a href="#sec-4-3-5">4.3.5. Routing on a Layer 3 Switch</a></li>
<li><a href="#sec-4-3-6">4.3.6. Routing Scenario on a Layer 3 Switch</a></li>
<li><a href="#sec-4-3-7">4.3.7. Routing Configuration on a Layer 3 Switch</a></li>
</ul>
</li>
<li><a href="#sec-4-4">4.4. Troubleshoot Inter-VLAN Routing</a>
<ul class="nav">
<li><a href="#sec-4-4-1">4.4.1. Common Inter-VLAN Issues</a></li>
<li><a href="#sec-4-4-2">4.4.2. Troubleshoot Inter-VLAN Routing Scenario</a></li>
<li><a href="#sec-4-4-3">4.4.3. Missig VLANs</a></li>
<li><a href="#sec-4-4-4">4.4.4. Switch Trunk Port Issues</a></li>
<li><a href="#sec-4-4-5">4.4.5. Switch Access Port Issues</a></li>
<li><a href="#sec-4-4-6">4.4.6. Router Configuration Issues</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-5">5. STP Concepts</a></li>
<li><a href="#sec-6">6. EtherChannel</a></li>
<li><a href="#sec-7">7. DHCPv4</a>
<ul class="nav">
<li><a href="#sec-7-1">7.1. DCHPv4 Concepts</a>
<ul class="nav">
<li><a href="#sec-7-1-1">7.1.1. DCHPv4 Server and Client</a></li>
<li><a href="#sec-7-1-2">7.1.2. DCHPv4 Operation</a></li>
<li><a href="#sec-7-1-3">7.1.3. Steps to Obtain a Lease</a></li>
<li><a href="#sec-7-1-4">7.1.4. Steps to Renew a Lease</a></li>
</ul>
</li>
<li><a href="#sec-7-2">7.2. Configure a Cisco IOS DHCPv4 Server</a>
<ul class="nav">
<li><a href="#sec-7-2-1">7.2.1. Steps to Configure a Cisco IOS DHCPv4 Server</a></li>
<li><a href="#sec-7-2-2">7.2.2. Configuration Example</a></li>
<li><a href="#sec-7-2-3">7.2.3. DHCPv4 Verification Commands</a></li>
<li><a href="#sec-7-2-4">7.2.4. Verify DHCPv4 is Operational</a></li>
<li><a href="#sec-7-2-5">7.2.5. Disable the Cisco IOS DHCPv4 Server</a></li>
<li><a href="#sec-7-2-6">7.2.6. DHCPv4 Relay</a></li>
</ul>
</li>
<li><a href="#sec-7-3">7.3. Configure a Cisco IOS DHCPv4 Client</a>
<ul class="nav">
<li><a href="#sec-7-3-1">7.3.1. Cisco Router as a DHCPv4 Client</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-8">8. SLAAC and DHCPv6</a></li>
<li><a href="#sec-9">9. FHRP Concepts</a></li>
<li><a href="#sec-10">10. LAN Security Concepts</a></li>
<li><a href="#sec-11">11. Switch Security Configuration</a>
<ul class="nav">
<li><a href="#sec-11-1">11.1. Implement Port Security</a>
<ul class="nav">
<li><a href="#sec-11-1-1">11.1.1. Secure Unused Ports</a></li>
<li><a href="#sec-11-1-2">11.1.2. Mitigate MAC Address Table Attacks</a></li>
<li><a href="#sec-11-1-3">11.1.3. Enable Port Security</a></li>
<li><a href="#sec-11-1-4">11.1.4. Limit and Learn MAC Addresses</a></li>
<li><a href="#sec-11-1-5">11.1.5. Port Security Aging</a></li>
<li><a href="#sec-11-1-6">11.1.6. Port Security Violation Modes</a></li>
<li><a href="#sec-11-1-7">11.1.7. Ports in error-disabled State</a></li>
<li><a href="#sec-11-1-8">11.1.8. Verify Port Security</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-12">12. WLAN Concepts</a></li>
<li><a href="#sec-13">13. WLAN Configuration</a></li>
<li><a href="#sec-14">14. Routing Concepts</a></li>
<li><a href="#sec-15">15. IP Static Routing</a></li>
<li><a href="#sec-16">16. Troubleshoot Static and Default Routes</a></li>
</ul>
</div>
</nav>
</div><div class="col-md-9 col-md-pull-3"><h1 class="title">Switching, Routing, and Wireles Essentials MOC.</h1>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Basic Device Configurations</h2>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Switching Concepts</h2>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> VLANs</h2>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> <span class="label label-primary TODO">TODO</span> Inter-VLAN Routing</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Inter-VLAN Routing Operation</h3>
<div class="outline-text-3" id="text-4-1">
</div><div id="outline-container-sec-4-1-1" class="outline-4">
<h4 id="sec-4-1-1"><span class="section-number-4">4.1.1</span> What is inter-VLAN Routing</h4>
</div>
<div id="outline-container-sec-4-1-2" class="outline-4">
<h4 id="sec-4-1-2"><span class="section-number-4">4.1.2</span> Legacy inter-VLAN Routing</h4>
</div>
<div id="outline-container-sec-4-1-3" class="outline-4">
<h4 id="sec-4-1-3"><span class="section-number-4">4.1.3</span> Router-on-a-Stick inter-VLAN Routing</h4>
</div>
<div id="outline-container-sec-4-1-4" class="outline-4">
<h4 id="sec-4-1-4"><span class="section-number-4">4.1.4</span> Inter-VLAN routing on a Layer 3 Switch</h4>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Router-on-a-Stick inter-VLAN Routing</h3>
<div class="outline-text-3" id="text-4-2">
</div><div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> Router-on-a-Stick scenario</h4>
</div>
<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2"><span class="section-number-4">4.2.2</span> S1 VLAN and Trunking Configuration</h4>
</div>
<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3"><span class="section-number-4">4.2.3</span> S2 VLAN and Trunking Configuration</h4>
</div>
<div id="outline-container-sec-4-2-4" class="outline-4">
<h4 id="sec-4-2-4"><span class="section-number-4">4.2.4</span> R1 Subinterface Configuration</h4>
</div>
<div id="outline-container-sec-4-2-5" class="outline-4">
<h4 id="sec-4-2-5"><span class="section-number-4">4.2.5</span> Verify Connectivity Between PC1 and PC2</h4>
</div>
<div id="outline-container-sec-4-2-6" class="outline-4">
<h4 id="sec-4-2-6"><span class="section-number-4">4.2.6</span> Router-on-a-Stick Inter-VLAN Routing Verification</h4>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Inter-VLAN Routing using Layer 3 Switches</h3>
<div class="outline-text-3" id="text-4-3">
</div><div id="outline-container-sec-4-3-1" class="outline-4">
<h4 id="sec-4-3-1"><span class="section-number-4">4.3.1</span> Layer 3 Switch Inter-VLAN Routing</h4>
</div>
<div id="outline-container-sec-4-3-2" class="outline-4">
<h4 id="sec-4-3-2"><span class="section-number-4">4.3.2</span> Layer 3 Switch Scenario</h4>
</div>
<div id="outline-container-sec-4-3-3" class="outline-4">
<h4 id="sec-4-3-3"><span class="section-number-4">4.3.3</span> Layer 3 Switch Configuration</h4>
</div>
<div id="outline-container-sec-4-3-4" class="outline-4">
<h4 id="sec-4-3-4"><span class="section-number-4">4.3.4</span> Layer 3 Switch Inter-VLAN Routing Verifcation</h4>
</div>
<div id="outline-container-sec-4-3-5" class="outline-4">
<h4 id="sec-4-3-5"><span class="section-number-4">4.3.5</span> Routing on a Layer 3 Switch</h4>
</div>
<div id="outline-container-sec-4-3-6" class="outline-4">
<h4 id="sec-4-3-6"><span class="section-number-4">4.3.6</span> Routing Scenario on a Layer 3 Switch</h4>
</div>
<div id="outline-container-sec-4-3-7" class="outline-4">
<h4 id="sec-4-3-7"><span class="section-number-4">4.3.7</span> Routing Configuration on a Layer 3 Switch</h4>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> Troubleshoot Inter-VLAN Routing</h3>
<div class="outline-text-3" id="text-4-4">
</div><div id="outline-container-sec-4-4-1" class="outline-4">
<h4 id="sec-4-4-1"><span class="section-number-4">4.4.1</span> Common Inter-VLAN Issues</h4>
</div>
<div id="outline-container-sec-4-4-2" class="outline-4">
<h4 id="sec-4-4-2"><span class="section-number-4">4.4.2</span> Troubleshoot Inter-VLAN Routing Scenario</h4>
</div>
<div id="outline-container-sec-4-4-3" class="outline-4">
<h4 id="sec-4-4-3"><span class="section-number-4">4.4.3</span> Missig VLANs</h4>
</div>
<div id="outline-container-sec-4-4-4" class="outline-4">
<h4 id="sec-4-4-4"><span class="section-number-4">4.4.4</span> Switch Trunk Port Issues</h4>
</div>
<div id="outline-container-sec-4-4-5" class="outline-4">
<h4 id="sec-4-4-5"><span class="section-number-4">4.4.5</span> Switch Access Port Issues</h4>
</div>
<div id="outline-container-sec-4-4-6" class="outline-4">
<h4 id="sec-4-4-6"><span class="section-number-4">4.4.6</span> Router Configuration Issues</h4>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> STP Concepts</h2>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> EtherChannel</h2>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> DHCPv4</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> DCHPv4 Concepts</h3>
<div class="outline-text-3" id="text-7-1">
</div><div id="outline-container-sec-7-1-1" class="outline-4">
<h4 id="sec-7-1-1"><span class="section-number-4">7.1.1</span> DCHPv4 Server and Client</h4>
<div class="outline-text-4" id="text-7-1-1">
<p>
DCHPv4 o <i>Dinamic Host Configuration Protocol v4</i> asigna direcciones y otros tipos de configuración de red dinámicamente.
</p>

<p>
Un router de cisco puede ser configurado para proveer servicios DHCPv4 sin la necesidad de un servidor dedicado.
</p>

<p>
El servidor DHCPv4 asigna o presta dinámicamente direcciones IPv4 de un grupo por un período de tiempo limitado definido por el servidor o hasta que el cliente ya no necesita la dirección.
</p>

<p>
A los clientes les es prestada la información del servidor comúnmente por 24h o hasta una semana,
cuando el tiempo expira el cliente debe pedir otra dirección,
aunque normalmente se le da la misma dirección.
</p>

<p>
Proceso:
</p>
<ol class="org-ol">
<li>El proceso de arrendamiento o prestamo, incia con el ciente mandando un mensaje pidiendo los servicios de un servidor DHCP.
</li>
<li>Si hay un Servidor DHCPv4 disponible, este recibe el mensaje y responde con una dirección IPv4 y otra información de configuración.
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-7-1-2" class="outline-4">
<h4 id="sec-7-1-2"><span class="section-number-4">7.1.2</span> DCHPv4 Operation</h4>
<div class="outline-text-4" id="text-7-1-2">
<p>
El protocolo DHCPv4 funciona en un modelo de Cliente/Servidor.
</p>

<ol class="org-ol">
<li>El servidor asigna o arrenda una dirección IPv4 a un cliente.
</li>
<li>El cliente se conceta a la red con esa dirección hasta que esta expira.
</li>
<li>El cliente debe contactar al servidor DHCP periodicamente para extender su arrendamiento.
</li>
</ol>

<p>
Este modelo permite que se reusen direcciones cuando no están en uso.
</p>
</div>
</div>

<div id="outline-container-sec-7-1-3" class="outline-4">
<h4 id="sec-7-1-3"><span class="section-number-4">7.1.3</span> Steps to Obtain a Lease</h4>
<div class="outline-text-4" id="text-7-1-3">
<p>
Cuando un cliente enciende o se conecta a una red empieza un proceso para optener un arrendamiento de IPv4.
</p>

<ol class="org-ol">
<li>DHCP Discover (DHCPDICOVER).
<ul class="org-ul">
<li>El cliente inicia el proceso con un mensaje broadcast DHCPDICOVER con su propia dirección MAC para encontrar un servidor DHCPv4.
</li>
<li>Usa broadcast de capa 2 y 3 para comunicarse con el servidor.
</li>
</ul>
</li>
<li>DHCP Offer (DHCPOFFER).
<ul class="org-ul">
<li>Cuando el servidor recibe un DHCPDICOVER, reserva una dirección IPv4 disponible para arrendarla al cliente.
</li>
<li>Crea una entrada ARP que consiste de la dirección MAC del cliente y la dirección asignada a este.
</li>
<li>Manda un mensaje DHCPOFFER al cliente.
</li>
</ul>
</li>
<li>DHCP Request (DHCPREQUEST)
<ul class="org-ul">
<li>El cliente recibe el DHCPOFFER y responde con un mensaje DHCPREQUEST.
</li>
<li>Este mensaje es usado para el arrendamiento y para la renovación del mismo.
</li>
</ul>
</li>
<li>DHCP Acknowledgment (DHCPACK)
<ul class="org-ul">
<li>Cuando el servidor recibe el DHCPREQUEST, puede verificar la información de arrendamiento con un mensake ICMP (ping) a la dirección asignada.
</li>
<li>Crea una nueva entrada ARP para el arrendamiento y responde con un DHCPACK.
</li>
<li>El DHCPACK es un duplicado del DHCPOFFER exepto por un cambio en el tipo de mensaje.
</li>
</ul>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-7-1-4" class="outline-4">
<h4 id="sec-7-1-4"><span class="section-number-4">7.1.4</span> Steps to Renew a Lease</h4>
<div class="outline-text-4" id="text-7-1-4">
<p>
Antes de que el arrendamiento termine,
el cliente inicia un proceso de dos pasos para renovar el arrendamiento.
</p>

<ol class="org-ol">
<li>DHCP Request (DHCPREQUEST).
Antes de que expire, el cliente manda un DHCPREQUEST directamente al servidor DHCPv4 que le ofreció su dirección IPv4,
Si no es recibida una respuesta DHCPACK, el cliente manda otro DHCPREQUEST.
</li>
<li>DHCP Acknowledgment (DHCPACK).
EL servidor verifica la información de arrendamiento y retorna un DHCPACK.
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2"><span class="section-number-3">7.2</span> Configure a Cisco IOS DHCPv4 Server</h3>
<div class="outline-text-3" id="text-7-2">
</div><div id="outline-container-sec-7-2-1" class="outline-4">
<h4 id="sec-7-2-1"><span class="section-number-4">7.2.1</span> Steps to Configure a Cisco IOS DHCPv4 Server</h4>
<div class="outline-text-4" id="text-7-2-1">
<p>
Se necesitan los siguientes pasos para Configurar un Servidor DHCPv4.
</p>
<ol class="org-ol">
<li>Exclude IPv4 Addresses
Excluimos algunas direcciones que no queremos que sean asignadas.
<pre class="example">
Router(config)# ip dhcp excluded-address low-address [high-address]
</pre>
</li>
<li>Define a DHCPv4 Pool Name
Asignamos un nombre a el conjunto de direcciones que vamos a arrendar.
<pre class="example">
Router(config)# ip dhcp pool pool-name
Router(dhcp-config)#
</pre>
</li>
<li>Configure the DHCPv4 Pool
El conjunto de direcciones (<i>address pool</i>) y la puerta de enlace predeterminada del ruter debe ser configurada,
Otros Comandos pueden ser opcionales.

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="left">
</colgroup>
<thead>
<tr>
<th scope="col" class="text-left">Task</th>
<th scope="col" class="text-left">IOS Command</th>
</tr>
</thead>
<tbody>
<tr>
<td class="text-left">Define the address pool</td>
<td class="text-left"><code>network network-number [mask/prefix-length]</code></td>
</tr>

<tr>
<td class="text-left">Define the default router or gateway</td>
<td class="text-left"><code>default-router address [ address2….address8]</code></td>
</tr>

<tr>
<td class="text-left">Define a DNS server</td>
<td class="text-left"><code>dns-server address [ address2…address8]</code></td>
</tr>

<tr>
<td class="text-left">Define the duration of the DHCP lease</td>
<td class="text-left"><code>lease {days [hours [minutes]]} infinite (simbolo or) infinite</code></td>
</tr>

<tr>
<td class="text-left">Define the domain name</td>
<td class="text-left"><code>domain-name domain</code></td>
</tr>

<tr>
<td class="text-left">Define the NetBIOS WINS server</td>
<td class="text-left"><code>netbios-name-server address [ address2…address8]</code></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-7-2-2" class="outline-4">
<h4 id="sec-7-2-2"><span class="section-number-4">7.2.2</span> Configuration Example</h4>
<div class="outline-text-4" id="text-7-2-2">
<p>
Este ejemplo muestra la configuración para hacer a R1 un servidor DHCPv4 para 192.168.10.0/24 LAN.
</p>
<pre class="example">
R1(config)# ip dhcp excluded-address 192.168.10.1 192.168.10.9
R1(config)# ip dhcp excluded-address 192.168.10.254
R1(config)# ip dhcp pool LAN-POOL-1
R1(dhcp-config)# network 192.168.10.0 255.255.255.0
R1(dhcp-config)# default-router 192.168.10.1
R1(dhcp-config)# dns-server 192.168.11.5
R1(dhcp-config)# domain-name example.com
R1(dhcp-config)# end
R1#
</pre>
</div>
</div>

<div id="outline-container-sec-7-2-3" class="outline-4">
<h4 id="sec-7-2-3"><span class="section-number-4">7.2.3</span> DHCPv4 Verification Commands</h4>
<div class="outline-text-4" id="text-7-2-3">
<dl class="org-dl">
<dt> <code>show running config | section dhcp</code> </dt><dd>Muestra los comandos de DHCPv4 configurados en el router.
</dd>
<dt> <code>show ip dhcp binding</code> </dt><dd>Muestra una lista de todas las direcciones MAC dadas por DHCPv4.
</dd>
<dt> <code>show ip dhcp server statistics</code> </dt><dd>Muestra información sobre el numero de mensajes DHCPv4 que se han sido enviados o recibidos.
</dd>
</dl>
</div>
</div>
<div id="outline-container-sec-7-2-4" class="outline-4">
<h4 id="sec-7-2-4"><span class="section-number-4">7.2.4</span> Verify DHCPv4 is Operational</h4>
<div class="outline-text-4" id="text-7-2-4">
<p>
Según una topología, R1 ha sido configurado para proveer servicios de DHCPv4,
PC1 aun no ha sido enciendido, asi que no tiene dirección IP.
</p>
</div>
<ol class="org-ol"><li><a id="sec-7-2-4-1" name="sec-7-2-4-1"></a>Verify the DHCPv4 Configuration<br ><div class="outline-text-5" id="text-7-2-4-1">
<p>
como se muestra en el ejemplo, el comando <code>show running-config | section dhcp</code>
muestra la configuración de R1, el parametro <code>| section dhcp</code> muestra solo la información relacionada con DHCPv4.
</p>

<pre class="example">
R1# show running-config | section dhcp
ip dhcp excluded-address 192.168.10.1 192.168.10.9
ip dhcp excluded-address 192.168.10.254
ip dhcp pool LAN-POOL-1
 network 192.168.10.0 255.255.255.0
 default-router 192.168.10.1
 dns-server 192.168.11.5
 domain-name example.com
</pre>
</div>
</li>

<li><a id="sec-7-2-4-2" name="sec-7-2-4-2"></a>Verify DHCPv4 Bindings<br ><div class="outline-text-5" id="text-7-2-4-2">
<p>
La operación de DHCPv4 puede ser verificada usando el comando <code>show ip dhcp binding</code>,
este muestra una lista de las relaciones IPv4 a MAC que fueron dadas por el servidor DHCPv4.
</p>

<pre class="example">
R1# show ip dhcp binding
Bindings from all pools not associated with VRF:
IP address      Client-ID/              Lease expiration        Type       State      Interface
                Hardware address/
                User name
192.168.10.10   0100.5056.b3ed.d8       Sep 15 2019 8:42 AM    Automatic  Active     GigabitEthernet0/0/0
</pre>
</div>
</li>

<li><a id="sec-7-2-4-3" name="sec-7-2-4-3"></a>Verify DHCPv4 Statics<br ><div class="outline-text-5" id="text-7-2-4-3">
<p>
Este comando muestr la el número de mensajes DHCPv4 que han sido mandados y recibidos.
</p>

<pre class="example">
R1# show ip dhcp server statistics
Memory usage         19465
Address pools        1
Database agents      0
Automatic bindings   2
Manual bindings      0
Expired bindings     0
Malformed messages   0
Secure arp entries   0
Renew messages       0
Workspace timeouts   0
Static routes        0
Relay bindings       0
Relay bindings active        0
Relay bindings terminated    0
Relay bindings selecting     0
Message              Received
BOOTREQUEST          0
DHCPDISCOVER         4
DHCPREQUEST          2
DHCPDECLINE          0
DHCPRELEASE          0
DHCPINFORM           0
</pre>
</div>
</li>

<li><a id="sec-7-2-4-4" name="sec-7-2-4-4"></a>Verify DHCPv4 Client Recieved IPv4 Adddressing<br ><div class="outline-text-5" id="text-7-2-4-4">
<p>
Con el comando <code>ipconfig /all</code> podemos ver si el cliente recibió la información del servidor DHCPv4.
</p>

<pre class="example">
C:\Users\Student&gt; ipconfig /all
Windows IP Configuration
   Host Name . . . . . . . . . . . . : ciscolab
   Primary Dns Suffix  . . . . . . . :
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : No
   WINS Proxy Enabled. . . . . . . . : No
Ethernet adapter Ethernet0:
   Connection-specific DNS Suffix  . : example.com &lt;-----
   Description . . . . . . . . . . . : Realtek PCIe GBE Family Controller
   Physical Address. . . . . . . . . : 00-05-9A-3C-7A-00
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes
   IPv4 Address. . . . . . . . . . . : 192.168.10.10 &lt;-----
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Lease Obtained  . . . . . . . . . : Saturday, September 14, 2019 8:42:22AM
   Lease Expires   . . . . . . . . . : Sunday, September 15, 2019 8:42:22AM
   Default Gateway . . . . . . . . . : 192.168.10.1 &lt;-----
   DHCP Server . . . . . . . .. . .  : 192.168.10.1
   DNS Servers . . . . . . . .. . .  : 192.168.11.5 &lt;-----
</pre>
</div>
</li></ol>
</div>
<div id="outline-container-sec-7-2-5" class="outline-4">
<h4 id="sec-7-2-5"><span class="section-number-4">7.2.5</span> Disable the Cisco IOS DHCPv4 Server</h4>
<div class="outline-text-4" id="text-7-2-5">
<p>
El servicio DHCPv4 esta activado por defecto,
para desactivarlo usamos el comando <code>no service dhcp</code>.
</p>

<pre class="example">
R1(config)# no service dhcp
R1(config)# service dhcp
R1(config)#
</pre>
</div>
</div>
<div id="outline-container-sec-7-2-6" class="outline-4">
<h4 id="sec-7-2-6"><span class="section-number-4">7.2.6</span> DHCPv4 Relay</h4>
<div class="outline-text-4" id="text-7-2-6">
<p>
En redes más complejas, los servidores de una empresa estan localizados de forma centralizada,
Estos proveen DHCP, DNS, TFTP y FTP por toda la red.
Y es problable que los cientes no esten en la misma Subred que esos servidores.
Para locarizar esos servidores se ocupan mensajes broadcast.
</p>


<figure>
<p><img src="./Images/Img-1.png" class="img-responsive" alt="Img-1.png">
</p>
<figcaption><span class="figure-number">Figure 1:</span> En este esenario se intenta renovar la información de direccionamiento de PC1.</figcaption>
</figure>

<p>
En la figura, PC1 intenta adquirir una dirección IPv4 de un servidor DHCPv4 usando un broadcast.
R1 no esta configurado como servidor DHCPv4 y no enruta los paquetes.
</p>
</div>

<ol class="org-ol"><li><a id="sec-7-2-6-1" name="sec-7-2-6-1"></a>ipconfig /release<br ><div class="outline-text-5" id="text-7-2-6-1">
<p>
Siendo PC1 una maquina con windows, verificamos la información de direccionamiento con el comando:
</p>
<pre class="example">
C:\Users\Student&gt; ipconfig /release
Windows IP Configuration
Ethernet adapter Ethernet0:
   Connection-specific DNS Suffix  . :
   Default Gateway . . . . . . . . . :
</pre>
</div>
</li>

<li><a id="sec-7-2-6-2" name="sec-7-2-6-2"></a>ipconfig /renew<br ><div class="outline-text-5" id="text-7-2-6-2">
<p>
Seguido, el administrador de red intenta renovar la dirección IPv4 con el comando <code>ipconfig /renew</code>.
Este comando manda un mensaje DHCPDICOVER.
</p>
<pre class="example">
C:\Users\Student&gt; ipconfig /renew
Windows IP Configuration
An error occurred while renewing interface Ethernet0 : unable to connect to your DHCP server. Request has timed out.
</pre>
</div>
</li>

<li><a id="sec-7-2-6-3" name="sec-7-2-6-3"></a>ip helper-address<br ><div class="outline-text-5" id="text-7-2-6-3">
<p>
Una mejor solución para configurar R1 es con el comando <code>ip helper-addres</code>.
Este hace que R1, releve los mensajes DHCPv4 al servidor DHCPv4.
</p>
<pre class="example">
R1(config)# interface g0/0/0
R1(config-if)# ip helper-address 192.168.11.6 &lt;--- dirección del servidor DHCP
R1(config-if)# end
R1#
</pre>
</div>
</li>

<li><a id="sec-7-2-6-4" name="sec-7-2-6-4"></a>show ip interface<br ><div class="outline-text-5" id="text-7-2-6-4">
<p>
Cuando R1 ha sido configurado como <i>relay agent</i> DHCPv4,
acepta los broadcast del servicio DHCPv4 y los manda al servidor DHCPv4.
El administrador puede usar el siguiente comando para verificar esta información.
</p>

<pre class="example">
R1# show ip interface g0/0/0
GigabitEthernet0/0/0 is up, line protocol is up
  Internet address is 192.168.10.1/24
  Broadcast address is 255.255.255.255
  Address determined by setup command
  MTU is 1500 bytes
  Helper address is 192.168.11.6
(output omitted)
</pre>
</div>
</li>

<li><a id="sec-7-2-6-5" name="sec-7-2-6-5"></a>ipcongig /all<br ><div class="outline-text-5" id="text-7-2-6-5">
<p>
Como se muestra en esta salida PC1 fue capaz de adquir información de direccionamiento.
</p>

<pre class="example">
C:\Users\Student&gt; ipconfig /all
Windows IP Configuration

Ethernet adapter Ethernet0:
   Connection-specific DNS Suffix  . : example.com
   IPv4 Address. . . . . . . . . . . : 192.168.10.10
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 192.168.10.1
</pre>
</div>
</li></ol>
</div>
</div>

<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3"><span class="section-number-3">7.3</span> Configure a Cisco IOS DHCPv4 Client</h3>
<div class="outline-text-3" id="text-7-3">
</div><div id="outline-container-sec-7-3-1" class="outline-4">
<h4 id="sec-7-3-1"><span class="section-number-4">7.3.1</span> Cisco Router as a DHCPv4 Client</h4>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> SLAAC and DHCPv6</h2>
</div>
<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> FHRP Concepts</h2>
</div>
<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> LAN Security Concepts</h2>
</div>
<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> Switch Security Configuration</h2>
<div class="outline-text-2" id="text-11">
</div><div id="outline-container-sec-11-1" class="outline-3">
<h3 id="sec-11-1"><span class="section-number-3">11.1</span> Implement Port Security</h3>
<div class="outline-text-3" id="text-11-1">
</div><div id="outline-container-sec-11-1-1" class="outline-4">
<h4 id="sec-11-1-1"><span class="section-number-4">11.1.1</span> Secure Unused Ports</h4>
<div class="outline-text-4" id="text-11-1-1">
<p>
Los dispositivos de capa 2 son los dispositivos más vulnerables en una infraestructura.
Todas las interfaces (puertos) deben de estar asegurados antes de que el switch sea usado.
</p>

<p>
La manera más fácil de asegurar puertos es desactivar los que no estan en uso.
</p>

<pre class="example">
Switch(config)# interface range type module/first-number – last-number
</pre>

<p>
Por ejemplo para apagar todos los puertos para Fa0/8 a través de Fa0/24 en S1.
</p>

<pre class="example">
S1(config)# interface range fa0/8 - 24
S1(config-if-range)# shutdown
%LINK-5-CHANGED: Interface FastEthernet0/8, changed state to administratively down
(output omitted)
%LINK-5-CHANGED: Interface FastEthernet0/24, changed state to administratively down
S1(config-if-range)#
</pre>
</div>
</div>

<div id="outline-container-sec-11-1-2" class="outline-4">
<h4 id="sec-11-1-2"><span class="section-number-4">11.1.2</span> Mitigate MAC Address Table Attacks</h4>
<div class="outline-text-4" id="text-11-1-2">
<p>
El método más efectivo para prevenir <i>overflow</i> de la tabla de direcciones MAC es habilitar seguridad de puertos.
</p>

<p>
Esta medida permite al switch aprender dinámicamente un número límitado de direcciones MAC,
permitiendo mitigar el acceso no autorizado al switch.
</p>
</div>
</div>

<div id="outline-container-sec-11-1-3" class="outline-4">
<h4 id="sec-11-1-3"><span class="section-number-4">11.1.3</span> Enable Port Security</h4>
</div>

<div id="outline-container-sec-11-1-4" class="outline-4">
<h4 id="sec-11-1-4"><span class="section-number-4">11.1.4</span> Limit and Learn MAC Addresses</h4>
</div>
<div id="outline-container-sec-11-1-5" class="outline-4">
<h4 id="sec-11-1-5"><span class="section-number-4">11.1.5</span> Port Security Aging</h4>
</div>
<div id="outline-container-sec-11-1-6" class="outline-4">
<h4 id="sec-11-1-6"><span class="section-number-4">11.1.6</span> Port Security Violation Modes</h4>
</div>
<div id="outline-container-sec-11-1-7" class="outline-4">
<h4 id="sec-11-1-7"><span class="section-number-4">11.1.7</span> Ports in error-disabled State</h4>
</div>
<div id="outline-container-sec-11-1-8" class="outline-4">
<h4 id="sec-11-1-8"><span class="section-number-4">11.1.8</span> Verify Port Security</h4>
</div>
</div>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> WLAN Concepts</h2>
</div>
<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> WLAN Configuration</h2>
</div>
<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> Routing Concepts</h2>
</div>
<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> IP Static Routing</h2>
</div>
<div id="outline-container-sec-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> Troubleshoot Static and Default Routes</h2>
</div>
</div></div></div>
<footer id="postamble" class="">
<div><p class="author">Author: J.D Castro</p>
<p class="date">Created: 2020-12-28 Mon 19:11</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="http://orgmode.org">Org-mode</a> 9.5)</p>
</div>
</footer>
</body>
</html>
